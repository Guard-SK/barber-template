---
import Section from './Section.astro';

interface Barber {
  name: string;
  role?: string; // napr. Senior Barber, Junior Barber...
  instagram?: string; // "@goldenchair.marek" alebo "goldenchair.marek"
  specialization?: string;
  imageSrc: string;
  imageAlt?: string;
}

interface Props {
  id?: string;
  title?: string;
  subtitle?: string;
  team: Barber[];
}

const {
  id = 'team',
  title = 'Tím',
  subtitle = 'Barberi, ktorí sa postarajú o tvoj nový look.',
  team,
} = Astro.props;

const getInstaUrl = (handle: string) =>
  `https://instagram.com/${handle.replace(/^@/, '')}`;
const getInstaLabel = (handle: string) =>
  `@${handle.replace(/^@/, '')}`;
---
<Section id={id} tone="default">
  {/* header */}
  <div class="sr mb-8 text-center">
    <h2 class="oswald text-4xl md:text-5xl font-semibold tracking-tight">
      {title}
    </h2>
    {subtitle && (
      <p class="mt-3 text-sm md:text-base text-foreground/70 max-w-xl mx-auto">
        {subtitle}
      </p>
    )}
  </div>

  {/* grid – responsive */}
  <div class="sr grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
    {team.members.map((barber, index) => (
      <article
        class="group overflow-hidden rounded-2xl border border-border/60 bg-muted-strong/70"
        style={`transition-delay: ${index * 60}ms;`}
      >
        {/* veľká foto tváre */}
        <div class="relative aspect-[4/5] sm:aspect-[3/4]">
          <img
            src={barber.imageSrc}
            alt={
              barber.imageAlt ||
              `Portrét barbera ${barber.name}.`
            }
            loading="lazy"
            class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.04]"
          />

          {/* jemný fade, nech text dole ostane čitateľný ak by si ho chcel dať na obrazok */}
          <div
            class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent"
            aria-hidden="true"
          />
        </div>

        {/* textová časť */}
        <div class="flex flex-col gap-1.5 p-4 md:p-5">
          <div class="flex items-baseline justify-between gap-3">
            <h3 class="text-sm font-semibold text-foreground">
              {barber.name}
            </h3>
            {barber.role && (
              <span class="text-[11px] uppercase tracking-wide text-foreground/55">
                {barber.role}
              </span>
            )}
          </div>

          {barber.instagram && (
            <a
              href={getInstaUrl(barber.instagram)}
              target="_blank"
              rel="noreferrer"
              class="inline-flex items-center gap-1 text-xs font-medium text-primary-soft hover:text-primary underline-offset-2 hover:underline"
            >
              <span>{getInstaLabel(barber.instagram)}</span>
              <span class="text-[10px]">↗</span>
            </a>
          )}

          {barber.specialization && (
            <p class="mt-1 text-xs text-foreground/75">
              {barber.specialization}
            </p>
          )}
        </div>
      </article>
    ))}
  </div>
</Section>
